<html>
<head>
    <title>Error Spam Prank</title>
    <HTA:APPLICATION 
        ID="ErrorSpamPrank"
        APPLICATIONNAME="ErrorSpamPrank"
        BORDER="none"
        CAPTION="no"
        SHOWINTASKBAR="no"
        SINGLEINSTANCE="yes"
        SYSMENU="no"
        WINDOWSTATE="normal">
    <script language="VBScript">
        Option Explicit
        Dim screenWidth, screenHeight, i, maxPopups, delay, windows
        
        ' Initialize variables
        screenWidth = window.screen.width
        screenHeight = window.screen.height
        i = 0
        maxPopups = 100  ' Limit to prevent overload
        delay = 1        ' Delay in milliseconds
        Set windows = CreateObject("Scripting.Dictionary")  ' Store windows for cleanup
        
        ' Function to create a new error window
        Sub CreateErrorWindow()
            If i < maxPopups Then
                i = i + 1
                Dim newWindow, x, y, htmlContent, windowID
                windowID = "ErrorWindow" & i
                
                ' Random position
                Randomize
                x = Int(Rnd * (screenWidth - 200))
                y = Int(Rnd * (screenHeight - 100))
                
                ' HTML content for the error window
                htmlContent = "<html><head><title>Error " & i & "</title></head>" & _
                              "<body style='background-color:#0000AA; color:white; font-family:Fixedsys,monospace; font-size:12px; margin:10px;'>" & _
                              "<b>ERROR: your pc is ratted! (Message " & i & ")</b><br>" & _
                              "<span style='color:yellow;'>Ez rat.</span>" & _
                              "</body></html>"
                
                ' Create new HTA window
                Set newWindow = window.open("about:blank", windowID, "width=200,height=100,left=" & x & ",top=" & y & ",menubar=no,toolbar=no,status=no")
                newWindow.document.write htmlContent
                newWindow.document.title = "Error " & i
                
                ' Store window reference
                windows.Add windowID, newWindow
                
                ' Schedule next window
                window.setTimeout "CreateErrorWindow", delay
            End If
        End Sub
        
        ' Handle key press for exit
        Sub document_onkeydown()
            If window.event.keyCode = 27 Then  ' Esc key
                Dim key
                For Each key In windows.Keys
                    windows(key).close
                Next
                window.close
            End If
        End Sub
        
        ' Start creating windows on load
        Sub window_onload()
            window.moveTo -1000, -1000  ' Hide main window
            CreateErrorWindow
        End Sub
    </script>
</head>
<body>
    <!-- Invisible main window -->
</body>
</html>