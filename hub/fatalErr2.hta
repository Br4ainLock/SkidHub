<html>
<head>
<title>FATAL SYSTEM ERROR</title>
<HTA:APPLICATION
    ID="oHTA"
    APPLICATIONNAME="SystemError"
    VERSION="1.0"
    BORDER="none"
    INNERBORDER="no"
    SCROLL="no"
    WINDOWSTATE="maximize"
    MAXIMIZEBUTTON="no"
    MINIMIZEBUTTON="no"
    SYSMENU="no"
    CAPTION="no"
/>

<style>
    body {
        font-family: 'Lucida Console', 'Courier New', monospace;
        background-color: #000093;
        color: #FFFFFF;
        overflow: hidden;
        margin: 0; padding: 0;
        height: 100vh; width: 100vw;
        display: flex; flex-direction: column;
        user-select: none;
        font-size: 11pt;
        line-height: 1.1em;
    }
    
    .bsod-header {
        padding: 20px;
        text-align: center;
        border-bottom: 2px solid #FFFFFF;
    }
    
    .error-code {
        font-size: 24pt;
        font-weight: bold;
        color: #FFFFFF;
        margin-bottom: 10px;
    }
    
    .stop-message {
        font-size: 14pt;
        color: #FFFFFF;
        margin-bottom: 20px;
    }
    
    .technical-info {
        padding: 0 20px 20px 20px;
        border-bottom: 2px solid #FFFFFF;
    }
    
    .tech-line {
        margin: 5px 0;
        white-space: nowrap;
    }
    
    .progress-section {
        padding: 20px;
    }
    
    .progress-text {
        font-size: 12pt;
        margin-bottom: 10px;
    }
    
    .progress-bar {
        width: 100%;
        height: 20px;
        background-color: #000000;
        border: 1px solid #FFFFFF;
        margin-bottom: 15px;
    }
    
    .progress-fill {
        height: 100%;
        background-color: #FF0000;
        width: 0%;
        transition: width 0.1s ease;
    }
    
    .system-log {
        flex: 1;
        padding: 20px;
        overflow-y: auto;
        background-color: #000000;
        border-top: 2px solid #FFFFFF;
    }
    
    .log-entry {
        margin: 2px 0;
        white-space: pre;
        font-size: 10pt;
    }
    
    .error-text { color: #FF0000; }
    .warning-text { color: #FFFF00; }
    .info-text { color: #FFFFFF; }
    
    .blink {
        animation: blink 1s infinite;
    }
    
    @keyframes blink {
        0%, 50% { opacity: 1; }
        51%, 100% { opacity: 0; }
    }
    
    .death-screen {
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        background: #000093;
        color: #FFFFFF;
        display: none;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        text-align: center;
        z-index: 1000;
        font-size: 18pt;
    }
    
    .skull {
        font-size: 72pt;
        margin-bottom: 20px;
    }
</style>

<script language="VBScript">
    Dim progress, logLines, popupWindows, phase, progressTimer, logTimer, popupTimer
    Dim errorMessages(5), logMessages(50)
    
    ' Initialize arrays
    errorMessages(0) = "*** STOP: 0x0000007B (0xF78D2524, 0xC0000034, 0x00000000, 0x00000000) INACCESSIBLE_BOOT_DEVICE ***"
    errorMessages(1) = "*** STOP: 0x00000050 (0xBAADF00D, 0x00000000, 0xF805F820, 0x00000002) PAGE_FAULT_IN_NONPAGED_AREA ***"
    errorMessages(2) = "*** STOP: 0x0000001E (0x80000003, 0x80106FC0, 0xF87B5A90) KMODE_EXCEPTION_NOT_HANDLED ***"
    errorMessages(3) = "*** STOP: 0x00000024 (0x00190293, 0xF885A3B0, 0xF885A0B8, 0xF87B5A90) NTFS_FILE_SYSTEM ***"
    errorMessages(4) = "*** STOP: 0x0000003B (0xC0000005, 0xF87B5A90, 0xF87B5A90, 0x00000000) SYSTEM_SERVICE_EXCEPTION ***"
    errorMessages(5) = "*** STOP: 0x000000D1 (0x0000000C, 0x00000002, 0x00000000, 0xF86B1C10) DRIVER_IRQL_NOT_LESS_OR_EQUAL ***"
    
    logMessages(0) = "ntoskrnl.exe: Initializing system shutdown sequence"
    logMessages(1) = "Beginning dump of physical memory"
    logMessages(2) = "Physical memory dump complete. Contacting system administrator..."
    logMessages(3) = "KERNEL_MODE_EXCEPTION_NOT_HANDLED"
    logMessages(4) = "win32k.sys: PAGE_FAULT_IN_NONPAGED_AREA"
    logMessages(5) = "Dump file: C:\Windows\Minidump\102225-01.dmp"
    logMessages(6) = "Registry corruption detected - 89% damaged"
    logMessages(7) = "File system integrity check FAILED"
    logMessages(8) = "System files corrupted - attempting repair... FAILED"
    logMessages(9) = "ntdll.dll access violation at 0x77F5A000"
    logMessages(10) = "CRITICAL: Master Boot Record overwritten"
    logMessages(11) = "WARNING: All user data marked for deletion"
    logMessages(12) = "System hive corruption level: 95%"
    logMessages(13) = "ERROR: Cannot access C:\Windows\System32"
    logMessages(14) = "Partition table modification complete"
    logMessages(15) = "BIOS settings wiped - permanent"
    logMessages(16) = "Network adapter drivers removed"
    logMessages(17) = "USB controllers disabled"
    logMessages(18) = "Audio devices uninstalled"
    logMessages(19) = "Graphics drivers corrupted"
    logMessages(20) = "CRITICAL: Hardware failure imminent"
    logMessages(21) = "System clock desynchronized by 127 hours"
    logMessages(22) = "Memory test: 47 errors found in 8GB RAM"
    logMessages(23) = "Disk scan: 8924 bad sectors on C: drive"
    logMessages(24) = "Recovery partition deleted successfully"
    logMessages(25) = "Boot sector reinitialized with malware signature"
    logMessages(26) = "All restore points removed"
    logMessages(27) = "Windows activation revoked permanently"
    logMessages(28) = "Admin privileges escalated to SYSTEM"
    logMessages(29) = "Windows Firewall service terminated"
    logMessages(30) = "Antivirus services terminated"
    logMessages(31) = "FINALIZING DATA WIPE... 100% complete"
    logMessages(32) = "SYSTEM DESTRUCTION COMPLETE"
    logMessages(33) = "ERROR: Disk write failure on sector 0x1A2B3C"
    logMessages(34) = "CRITICAL: Kernel panic detected"
    logMessages(35) = "WARNING: System integrity compromised"
    logMessages(36) = "INFO: Encrypting remaining data fragments"
    logMessages(37) = "ERROR: Boot manager corrupted"
    logMessages(38) = "CRITICAL: TPM chip disabled"
    logMessages(39) = "WARNING: Secure Boot bypassed"
    logMessages(40) = "INFO: Sending telemetry data to [REDACTED]"
    logMessages(41) = "ERROR: Cannot mount C: drive"
    logMessages(42) = "CRITICAL: All partitions reformatted"
    logMessages(43) = "WARNING: User profile deleted"
    logMessages(44) = "INFO: System restore disabled"
    logMessages(45) = "ERROR: Hardware ID stolen"
    logMessages(46) = "CRITICAL: BIOS password set"
    logMessages(47) = "FINAL: Self-destruct sequence initiated"
    logMessages(48) = "ERROR: Power supply failure detected"
    logMessages(49) = "SYSTEM: SHUTDOWN IMMINENT"
    
    Sub Window_OnLoad
        Randomize
        progress = 0
        logLines = 0
        phase = 1
        Set popupWindows = CreateObject("Scripting.Dictionary")
        Call initBSOD
    End Sub
    
    Sub initBSOD
        ' Set random error code
        Dim randIndex : randIndex = Int(Rnd * 6)
        Document.getElementById("error-code").innerText = errorMessages(randIndex)
        Document.getElementById("stop-text").innerText = "A problem has been detected and Windows has been shut down to prevent damage to your computer."
        
        ' Start timers - FIXED: Proper VBScript timer handling
        progressTimer = Window.setInterval("updateProgress", 150)
        logTimer = Window.setInterval("addLogEntry", 120)
        Window.setTimeout "startErrorPopups", 3000
        Window.setTimeout "showDeathScreen", 12000
        
        ' ESC key handler - FIXED: Proper VBScript event
        Set Document.onkeydown = GetRef("handleKeyPress")
    End Sub
    
    Sub updateProgress
        If phase = 1 Then
            progress = progress + (Rnd * 3 + 1)
            If progress > 100 Then 
                progress = 100
                phase = 2
                Window.setTimeout "showDeathScreen", 2000
            End If
            
            Dim fill : Set fill = Document.getElementById("progress-fill")
            fill.style.width = CStr(progress) & "%"
            
            Dim status : Set status = Document.getElementById("progress-text")
            If progress < 25 Then
                status.innerText = "Initializing system failure..."
            ElseIf progress < 50 Then
                status.innerText = "Corrupting critical files..."
            ElseIf progress < 75 Then
                status.innerText = "Deleting user data..."
            Else
                status.innerText = "FINALIZING DESTRUCTION..."
            End If
            
            If Int(progress) Mod 10 = 0 And progress > 10 Then
                Call PlayBeepSound
            End If
        End If
    End Sub
    
    Sub addLogEntry
        If logLines >= 15 Then
            Dim logDiv : Set logDiv = Document.getElementById("system-log")
            If logDiv.children.length > 0 Then
                logDiv.removeChild logDiv.firstChild
                logLines = logLines - 1
            End If
        End If
        
        Dim msgIndex : msgIndex = Int(Rnd * 50)
        Dim msg : msg = logMessages(msgIndex)
        
        Dim entry : Set entry = Document.createElement("DIV")
        entry.className = "log-entry"
        
        If InStr(msg, "ERROR") > 0 Or InStr(msg, "CRITICAL") > 0 Or InStr(msg, "FAILED") > 0 Then
            entry.innerHTML = "<span class=""error-text"">" & msg & "</span>"
        ElseIf InStr(msg, "WARNING") > 0 Then
            entry.innerHTML = "<span class=""warning-text"">" & msg & "</span>"
        Else
            entry.innerHTML = "<span class=""info-text"">" & msg & "</span>"
        End If
        
        Dim logDiv2 : Set logDiv2 = Document.getElementById("system-log")
        logDiv2.appendChild entry
        logLines = logLines + 1
        logDiv2.scrollTop = logDiv2.scrollHeight
        
        If InStr(msg, "ERROR") > 0 Or InStr(msg, "CRITICAL") > 0 Then
            Call PlayBeepSound
        End If
    End Sub
    
    Sub startErrorPopups
        popupTimer = Window.setInterval("createErrorPopup", 300)
    End Sub
    
    Sub createErrorPopup
        If popupWindows.Count >= 12 Then Exit Sub
        
        Dim w, h, x, y
        w = 400 + Int(Rnd * 100)
        h = 250 + Int(Rnd * 50)
        x = Int(Rnd * (screen.width - w))
        y = Int(Rnd * (screen.height - h))
        
        Dim popup
        Set popup = Window.open("", "error" & Timer, "width=" & w & ",height=" & h & ",left=" & x & ",top=" & y & ",toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=no,resizable=no")
        
        If Not popup Is Nothing Then
            popup.document.write "<html><head><title>CRITICAL SYSTEM ERROR</title><style>body{font-family:'Lucida Console',monospace;background:#000093;color:#FFFFFF;padding:15px;font-size:10pt;margin:0;}</style></head><body><div style='border:2px solid #FFFFFF;padding:15px;'><div style='font-size:16pt;font-weight:bold;color:#FF0000;margin-bottom:10px;'>*** SYSTEM FAILURE ***</div><div>Error " & FormatNumber(Int(Rnd*99999), 0) & ": " & Array("CRITICAL PROCESS TERMINATED", "HARD DRIVE FAILURE", "MEMORY CORRUPTION", "BOOT SECTOR DAMAGED", "KERNEL PANIC")(Int(Rnd*5)) & "</div><div style='color:#FFFF00;margin:10px 0;'>ALL DATA WILL BE LOST</div><div style='margin-top:15px;font-size:9pt;'>Press any key to ignore (WON'T WORK)</div></div></body></html>"
            popup.document.close()
            popupWindows.Add CStr(popupWindows.Count), popup
            Call PlayBeepSound
        End If
    End Sub
    
    Sub showDeathScreen
        ' Stop all timers
        Window.clearInterval progressTimer
        Window.clearInterval logTimer
        Window.clearInterval popupTimer
        
        ' Close all popups
        Dim i, keys : keys = popupWindows.Keys
        For i = 0 To UBound(keys)
            On Error Resume Next
            popupWindows.Item(keys(i)).close()
            On Error Goto 0
        Next
        
        ' Hide main content and show death screen
        Dim mainContent : Set mainContent = Document.getElementById("main-content")
        mainContent.style.display = "none"
        
        Dim deathScreen : Set deathScreen = Document.getElementById("death-screen")
        deathScreen.style.display = "flex"
        
        ' Rapid beeps
        Dim j
        For j = 1 To 10
            Window.setTimeout "PlayBeepSound", 200 * j
        Next
    End Sub
    
    Sub PlayBeepSound
        On Error Resume Next
        Beep 800, 100
        On Error Goto 0
    End Sub
    
    Sub handleKeyPress
        Dim e : Set e = window.event
        If e.keyCode = 27 Then
            Call stopEverything
        Else
            Call PlayBeepSound
        End If
    End Sub
    
    Sub stopEverything
        ' Stop all timers
        Window.clearInterval progressTimer
        Window.clearInterval logTimer
        Window.clearInterval popupTimer
        
        ' Close all popups
        Dim i, keys : keys = popupWindows.Keys
        For i = 0 To UBound(keys)
            On Error Resume Next
            popupWindows.Item(keys(i)).close()
            On Error Goto 0
        Next
        
        On Error Resume Next
        window.close()
        On Error Goto 0
    End Sub
</script>

</head>
<body>
    <div id="main-content">
        <div class="bsod-header">
            <div class="error-code blink" id="error-code"></div>
            <div class="stop-message" id="stop-text"></div>
        </div>
        
        <div class="technical-info">
            <div class="tech-line">DRIVER_IRQL_NOT_LESS_OR_EQUAL           ntkrnlmp.exe</div>
            <div class="tech-line">Arg1: c0000005, Exception occurred at address 804E7A4E</div>
            <div class="tech-line">Arg2: 804E7A4E, Address referenced from 804E7A4E</div>
            <div class="tech-line">Arg3: f86b1c10, IRQL was 2 when HIGH_IRQL was referenced</div>
            <div class="tech-line">Arg4: 0, Address which referenced memory</div>
        </div>
        
        <div class="progress-section">
            <div class="progress-text" id="progress-text">Initializing system failure...</div>
            <div class="progress-bar">
                <div class="progress-fill" id="progress-fill"></div>
            </div>
        </div>
        
        <div class="system-log" id="system-log"></div>
    </div>
    
    <div class="death-screen" id="death-screen">
        <div class="skull">☠</div>
        <div style="font-size: 24pt; margin-bottom: 20px; color: #FF0000;">SYSTEM ANNIHILATED</div>
        <div style="font-size: 14pt; margin-bottom: 10px;">ALL DATA PERMANENTLY DELETED</div>
        <div style="font-size: 12pt; color: #FFFF00;">DRIVE FORMATTED</div>
        <div style="font-size: 10pt; margin-top: 30px;">Press ESC for service tag: [X9K-4M7-P2N]</div>
        <div style="font-size: 8pt; margin-top: 20px;">Windows has encountered a fatal error and must restart.</div>
    </div>
</body>
</html>